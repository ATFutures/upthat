<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adaptation manual • upthat</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Adaptation manual">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">upthat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/upthat.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/adaptation.html">Adaptation manual</a>
    </li>
    <li>
      <a href="../articles/scenarios.html">Upthat scenarios</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Adaptation manual</h1>
            
      
      
      <div class="hidden name"><code>adaptation.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The Upthat manual describes the ‘front end’ of the tool, which has been designed to be used by practitioners, policy-makers and interested members of the public. This document reports the ‘back-end’ of the web application and the framework it uses to estimate modal shift at the city level. It is designed to be used by developers, researchers and data analysts. The aim is to show how the tool was built.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
</div>
<div id="scenarios" class="section level1">
<h1 class="hasAnchor">
<a href="#scenarios" class="anchor"></a>Scenarios</h1>
<p>This section documents deliverable 2, scenario development, for the WHO Upthat project, which involves: (1) setting out high level policy scenarios of active transport uptake; (2) converting these changes into estimates of rates of shift towards walking and cycling down to route network levels; and (3) simulating the impacts of these scenarios on walking and cycling levels citywide. Scenario development will also be informed by the transport scenarios assessed in Accra and Kathmandu as part of UHI project activities.</p>
<!-- # High level policy scenarios of active transport uptake -->
<p>High level priorities are to improve population health, air quality and safety levels. This means increasing the proportion of the population that gets regular physical activity, reducing motorized vehicle use in urban centers and providing walking and cycling routes that are away from or otherwise protected from motor traffic. Urban transport policies can meet each of these objectives, creating ‘win win win’ options. Reducing car use, for example, will directly improve air quality and indirectly improve health and safety levels.</p>
<p>Specific scenarios of change include:</p>
<ul>
<li>‘Get walking’, referring to a global (meaning without spatial input components, but with spatially distributed consequences) walking uptake, as a result of citywide policies to promote safe and attractive walking.</li>
<li>‘Get cycling’, referring to a global scenario of cycling, as a result of citywide policies to provide safe cycleways.</li>
<li>‘Car diet’, a global, citywide scenario of multi-modal transport change, showing reduced levels of driving following disincentives to own and use cars.</li>
<li>‘Go public transport’, a global scenario of public transport uptake, linked to <a href="https://sustainabledevelopment.un.org/sdg11">SDG 11</a>.</li>
<li>‘Car free’, meaning investment in car free city centers, other car free spaces and other policies to reduce car ownership and use such as reductions in specific car parking spaces.</li>
</ul>
<div id="citywide-scenarios-of-change" class="section level2">
<h2 class="hasAnchor">
<a href="#citywide-scenarios-of-change" class="anchor"></a>Citywide scenarios of change</h2>
<p>To calculate scenarios of change, the minimum data requirements are the region’s current modal split and data that can be used as explanatory variables, including data on transport infrastructure and car parking spaces, and data on the provision of public transport options.</p>
<p>Mode split is one of the fundamental pieces of information that is known for most cities. For context, it’s useful to take a step back and consider the range of modal splits observed in a sample of cities worldwide. Many sources of mode share data are available, including the following (none of which were used due lack of access to the underlying data or other issues):</p>
<ul>
<li>
<a href="https://transportgeography.org/?page_id=5055">Transport Geography website</a>, which provides an image of mode split</li>
<li>
<a href="http://www.epomm.eu/tems/">The TEMS mode split tool</a>, which provides a map but not the underlying data</li>
<li><a href="https://www.thetransportpolitic.com/databook/travel-mode-shares-in-the-u-s/">Various country-specific datasets</a></li>
</ul>
<p>A problem with many datasets on mode split is that they ignore or oversimplify active transport <span class="citation">(e.g. Aguil’era and Gr’ebert 2014)</span>. Examples of this are the <a href="https://stats.oecd.org/Index.aspx?DataSetCode=ITF_PASSENGER_TRANSPORT">OECD</a> passenger transport dataset and the European Union’s Modal split of inland passenger transport, 2016 webpage, which omits walking and cycling:</p>
<p><img src="https://ec.europa.eu/eurostat/statistics-explained/images/a/a8/Modal_split_of_inland_passenger_transport%2C_2016_%28%25_share_in_passenger-kilometres%29.png" width="50%"></p>
<p><strong>This suggests the need for an open, international dataset on modal splits in major cities over time</strong>. To overcome these issues we searched for crowd-sourced data on mode split. The figure below shows the diversity in mode splits based on 108 (primarily wealthy) cities, based on data of the type shown in the table below from <a href="https://en.wikipedia.org/wiki/Modal_share">Wikipedia</a>.</p>
<table class="table">
<thead><tr class="header">
<th align="left">City</th>
<th align="right">walking</th>
<th align="right">cycling</th>
<th align="right">pt</th>
<th align="right">car</th>
<th align="right">other</th>
<th align="right">year</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Detroit</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">92</td>
<td align="right">5</td>
<td align="right">2016</td>
</tr>
<tr class="even">
<td align="left">Amsterdam</td>
<td align="right">4</td>
<td align="right">40</td>
<td align="right">29</td>
<td align="right">27</td>
<td align="right">0</td>
<td align="right">2014</td>
</tr>
<tr class="odd">
<td align="left">Bratislava</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">70</td>
<td align="right">26</td>
<td align="right">0</td>
<td align="right">2004</td>
</tr>
<tr class="even">
<td align="left">Osaka</td>
<td align="right">27</td>
<td align="right">21</td>
<td align="right">34</td>
<td align="right">18</td>
<td align="right">0</td>
<td align="right">2000</td>
</tr>
<tr class="odd">
<td align="left">Helsinki</td>
<td align="right">37</td>
<td align="right">10</td>
<td align="right">30</td>
<td align="right">22</td>
<td align="right">1</td>
<td align="right">2016</td>
</tr>
</tbody>
</table>
<p>The figure shows that cars dominate the transport systems of most cities, accounting for a mode shares ranging from 18% (Osaka, Japan) to 85% (Adelaide, Australia). A more useful way to view travel systems from an active transport perspective is to view walking as the foundation of transport systems and all other modes to supplement walking <span class="citation">(Tight et al. 2011)</span>. This view is shown on the right of the figure, which shows walking mode shares in the sample of cities ranging from only 3% to more than 1/3rd (in Madrid, Spain and Vilnius, Lithuania). It is interesting to note that while there is a roughly even distribution of mode shares by car, other modes have more skewed distributions. This could reflect the diversity of policies used to promote walking, cycling and public transport and the fact that cars tend to be the default. This implication is that <strong>if no policies have been implemented to promote alternatives, cars dominate</strong>.</p>
<p><img src="https://github.com/ATFutures/who3/raw/master/figures/city-mode-split-wiki.png" width="100%"></p>
<p>The relationships between the different modes is illustrated in the figure below, which suggests competition between all modes and cars (with public transport seeming to be the biggest deterrent to driving in this dataset), and synergies between public transport and walking. <strong>This suggests that a reliable way to encourage walking in cities is through investment in public transport.</strong></p>
<p><img src="https://github.com/ATFutures/who3/raw/master/figures/city-mode-cor.png" width="50%"></p>
<p>This city level data allows models of mode split to be developed, assuming there are sufficient explanatory variables defining the transport system.</p>
</div>
<div id="transport-system-data" class="section level2">
<h2 class="hasAnchor">
<a href="#transport-system-data" class="anchor"></a>Transport system data</h2>
<p>Transport systems are complex, composed of hundreds of interrelated elements. For modelling purposes, it makes sense to condense available datasets down into a few key parameters per city, zone or origin-destination pair. The process of identifying and quantifying transport system variables should be be an open-ended and adaptable process that is able to respond when the input data changes (e.g. due to changes in the transport system or improved data availability/collection). The <a href="https://data.london.gov.uk/dataset/global-city-data">Global City Data</a> dataset provides several transport-related variables on major cities, but the data are highly skewed towards wealthy cities, and are thus not suitable for developing nations. Instead, data from the <a href="https://www.naturalearthdata.com/downloads/10m-cultural-vectors/10m-populated-places/">Natural Earth</a> open data repository was used for basic city statistics, including (the ones used in this project):</p>
<ul>
<li>Population</li>
<li>Area (km<sup>2</sup>)</li>
<li>Elevation</li>
<li>Country</li>
</ul>
<p>The city data, with these explanatory variables added, are shown in the figure below</p>
<p><img src="https://github.com/ATFutures/who3/raw/master/figures/cities-area-population.png"><!-- --></p>
<p>A framework for estimating mode share needs to be flexible, to incorporate additional/modified variables that will become available. We suggest focussing on ‘scale free’, meaning that they do not depend on the city’s size. The scale free nature of such measures also means that they can be used to estimate mode shares not only at city levels but also at the level of ‘desire lines’ connecting origins and destinations, as with the use of average gradient as a predictor of cycling potential in the PCT <span class="citation">(Lovelace et al. 2017)</span>. Some additional variables, such as distance and relative time/cost for alternative modes, only make sense when measured at the OD level.</p>
</div>
<div id="modelling-mode-shift" class="section level2">
<h2 class="hasAnchor">
<a href="#modelling-mode-shift" class="anchor"></a>Modelling mode shift</h2>
<p>Treating mode share as a dependent variable involves multiple interrelated dependent variables, which is problematic for standard regression approaches. An alternative used in cycling potential research has been to ‘expand’ mode split data into individual categorical variables <span class="citation">(Lovelace et al. 2017, supplementary information)</span>. This strategy is computationally intensive however.</p>
<p>The datasets presented in the previous section are examples of proportional outcomes, where we are interested in the mode split of all travel in a city. These types of data are common in ecological modelling <span class="citation">(Douma and Weedon 2019)</span>, which provided a basis for investigating the question of citywide scenarios of mode shift in which modes are analogous to species. Dirichlet regression is a recently developed technique for modelling proportions based on a range of dependent variables <span class="citation">(Maier 2014)</span>.</p>
<p>Building on this work, support for Dirichlet regression was added to the R package <code>brms</code> <span class="citation">(Bürkner 2017)</span>, which implements a Bayesian modelling framework based on the stan C++ library, in 2018. The advantage of <code>brms</code> is that it estimates uncertainty, vital for effective ‘no-regrets’ policy making. A basic example of the outputs of a Dirichlet regression model run are shown in the figure below, which represents the result of a model run for a subset of 28 cities for which we have access to population (other explanatory variables included provision of metro and bikeshare schemes).</p>
<p><img src="https://github.com/ATFutures/who3/raw/master/figures/mode-share-prediction.png" width="50%"><img src="https://github.com/ATFutures/who3/raw/master/figures/mode-share-prediction-metro.png" width="50%"></p>
<p>The result suggest that beyond a certain size, increasingly large city populations are associated with a lower proportion of trips made by driving in the sample of cities used. More explanatory variables can be added using this framework, including categorical variables such as <code>has_metro</code>, the results of which (that increase the mode share by public transport and notably walking in the results, which also show confidence intervals) are shown. Of course, the quality of the prediction relies on good input data predicting mode shift and relies on the assumption that cities are in equilibrium states. <strong>This strengthens the need for open data on mode shift at city, OD and local levels over time following a range of interventions.</strong></p>
<p>Results using different explanatory variables on a slightly larger dataset (n = 101) show the generalize-ability of the modelling framework. The figure below shows more policy relevant explanatory variables: number of bus stops per inhabitant and the provision of a tram system, which is more viable in many cities than a metro system.</p>
<p><img src="https://github.com/ATFutures/who3/raw/master/figures/mode-share-prediction-bus-stops-100.png" width="50%"><img src="https://github.com/ATFutures/who3/raw/master/figures/mode-share-has-tram.png" width="50%"></p>
<p>The figure above shows the <em>marginal effect</em> of changes to one variable, holding all other variables equal. <strong>The model accounts for fixed effects such as population density that are hard to change with policy interventions.</strong> The relationship between population density and mode split is interesting in itself however, as shown in the figure below.</p>
<p><img src="https://github.com/ATFutures/who3/raw/master/figures/mode-share-prediction-density-100.png" width="60%" style="display: block; margin: auto;"></p>
<p>Of course, we need more input data than the 101 cities taken from open data repositories shown above to reduce the confidence intervals. However, we have clearly demonstrated a robust and highly flexible way to model mode shift that accounts for the interrelations between different transport modes. The next step is to apply these models to real city datasets.</p>
</div>
<div id="estimates-of-rates-of-shift-towards-walking-and-cycling-down-to-route-network-levels" class="section level2">
<h2 class="hasAnchor">
<a href="#estimates-of-rates-of-shift-towards-walking-and-cycling-down-to-route-network-levels" class="anchor"></a>Estimates of rates of shift towards walking and cycling down to route network levels</h2>
<p>Taking Accra as an example, let’s see how the modelling framework can estimate mode shift (remember this is based on a small input dataset and a proof of concept rather than final results).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># note: depends on data in the who3 repo</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">cities =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="st">"cities.Rds"</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">m =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span>(<span class="st">"model-result-brms-density-bus-stops-101.Rds"</span>)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span>(m)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">accra =<span class="st"> </span>cities <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(City <span class="op">==</span><span class="st"> "Accra"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Density =</span> Population <span class="op">/</span><span class="st"> </span>Area) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="st">  </span><span class="kw">select</span>(Density, bus_stops_per_<span class="dv">1000</span>, has_tram, <span class="op">-</span>geometry)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">City</th>
<th align="right">Density</th>
<th align="right">bus_stops_per_1000</th>
<th align="left">has_tram</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">Accra</td>
<td align="right">4787.81</td>
<td align="right">1.23008</td>
<td align="left">FALSE</td>
</tr></tbody>
</table>
<p>The current mode split can be estimated as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">mode_share_current_estimate =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(m, accra)[, , ]</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">walking</th>
<th align="right">cycling</th>
<th align="right">pt</th>
<th align="right">car</th>
<th align="right">other</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Estimate</td>
<td align="right">0.14</td>
<td align="right">0.05</td>
<td align="right">0.18</td>
<td align="right">0.59</td>
<td align="right">0.04</td>
</tr>
<tr class="even">
<td align="left">Est.Error</td>
<td align="right">0.11</td>
<td align="right">0.07</td>
<td align="right">0.13</td>
<td align="right">0.16</td>
<td align="right">0.07</td>
</tr>
<tr class="odd">
<td align="left">Q2.5</td>
<td align="right">0.01</td>
<td align="right">0.00</td>
<td align="right">0.01</td>
<td align="right">0.27</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">Q97.5</td>
<td align="right">0.43</td>
<td align="right">0.25</td>
<td align="right">0.48</td>
<td align="right">0.88</td>
<td align="right">0.24</td>
</tr>
</tbody>
</table>
<p>In the PT scenario, we can increase the provision of buses to 10 per 1000 people, representing a high level of provision within the range of the sample of cities worldwide:</p>
<p><strong>Estimated change in mode share (percentage points)</strong></p>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">walking</th>
<th align="right">cycling</th>
<th align="right">pt</th>
<th align="right">car</th>
<th align="right">other</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">Central estimate</td>
<td align="right">0.8</td>
<td align="right">0.5</td>
<td align="right">1.1</td>
<td align="right">-1.9</td>
<td align="right">-0.5</td>
</tr></tbody>
</table>
<p>The result can be shown graphically, as shown in the figure below, that shows mode split estimates under the two model experiment conditions: one in which Accra has 1.2 bus stops per person (as it does currently) and one in which it has 3. The x axis shows that this model experiment can be generalized over the parameter space, in this case with x representing density, and the vertical line representing Accra’s density (~5000 people per km2):</p>
<p><img src="https://github.com/ATFutures/who3/raw/master/figures/mode-share-prediction-accra.png"><!-- --></p>
<p>Under this scenario, the central estimate of car use drops by 12 percentage points while the central estimates for walking and cycling grow, by 2 percentage points and 4 percentage points, respectively. This highlights the synergies between active transport modes and bus use implicit in the data, <strong>suggesting that a combination of strong investment in public transport and active transport infrastructure can be complimentary.</strong> As mentioned already, larger input datasets, in particular with more example datasets from Africa and the developing world in general in this context, are needed to reduce the large confidence intervals around these estimates.</p>
<p>The framework enables us to model changes in mode share that would result from changes in any variable, categorical or continuous. Based on the input data, the impact of a tram system in Accra could be simulated as follows:</p>
<p>As with any model, the usefulness of the outputs rely on the quality of the inputs and the assumptions underlying the model. These limitations, which reflect the paucity of open, curated data on mode shift in cities internationally, are covered in the next section. They are such that the current data (which only has one data point in Africa and only a handful of cities in the developing world) is not deemed of sufficient size and diversity to make useful predictions of modal shift. Instead of presenting results based on limited input data, the remainder of this section outlines how mode shift <em>could</em> be estimated, provided sufficiently large and diverse input dataset on mode shift following interventions. The basic tenets of this method are that:</p>
<ul>
<li>Mode share in cities depends on measurable transport system characteristics such as number of bus stops, length of footways and walkways and cycleways and other explanatory variables.</li>
<li>A sufficiently large and diverse dataset on mode share and explanatory variables can be collected. In the examples presented here, the dependent variables are the more problematic data to access: we can get data on transport system characteristics by bulk download and analysis of large OSM datasets (although this is a time consuming and computationally intensive task).</li>
</ul>
<p>Based on these tenets, an approach to estimate mode shift in response to the scenarios outlined above is detailed below. We have shown that we can model multi-modal responses to continuous and categorical variables in a robust Bayesian framework with explicit treatment of uncertainty. Under this framework, the scenario definition can be simplified to the identification and modification of explanatory variables that are available at the city level for a sufficiently large sample (500+) settlements with sufficient diversity to represent the changes that could take place in the cities under consideration.</p>
<p>Changes could be made in a systematic way to each of the predictors to represent change on the ground. Adding amounts to continuous variables by amounts determined by the input data, e.g. with 25<sup>th</sup>, 50<sup>th</sup> and 75<sup>th</sup> percentile increases representing low, medium and high levels of change, with a modifier (e.g. <span class="math inline">\(1 - current_provision / max_provision\)</span> ) to represent the law of diminishing returns, would be one way to achieve this (that was roughly the approach used in the example scenario of increasing bus stop provision in Accra).</p>
<p>To provide a concrete example, imagine that the maximum number of bus stops in the city dataset is 15 per 1000 people and that the 75<sup>th</sup> percentile level of provision is 3 bus stops per 1000. In this case, an ambitious increase would be calculated for cities that currently have no bus stops, 1 bus stop, 10 and 15 bus stops per person as follows:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">max_provision =<span class="st"> </span><span class="dv">15</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">max_increase_in_provision =<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">current_provision =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">  <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">  <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">  <span class="dv">15</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8">)</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">modifier =<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>current_provision <span class="op">/</span><span class="st"> </span>max_provision)</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">increase_in_provision =<span class="st"> </span>max_increase_in_provision <span class="op">*</span><span class="st"> </span>modifier</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">future_provision =<span class="st"> </span>current_provision <span class="op">+</span><span class="st"> </span>increase_in_provision </a>
<a class="sourceLine" id="cb3-12" data-line-number="12">future_provision</a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt; [1]  3.0  3.8 11.0 15.0</span></a></code></pre></div>
<p>For categorical variables, the changes are simpler: a one-size-fits-all change to a categorical variable that will only affect cities that do not currently have a specific piece of infrastructure (e.g. a tram system in the example above).</p>
<div id="get-walking" class="section level3">
<h3 class="hasAnchor">
<a href="#get-walking" class="anchor"></a>Get walking</h3>
<p>This scenario refers to a global (meaning without spatial input components, but with spatially distributed consequences) walking uptake, as a result of citywide policies to promote safe and attractive walking.</p>
<p>Key variables that are readily available for most cities, that could be modified by policies, include <span class="citation">(Kerr Jacqueline et al. 2016)</span>:</p>
<ul>
<li>Provision of walking infrastructure, for example the percentage of the city’s transport network that is footway</li>
<li>Average distance of demand-weighted walking routes from major (and therefore likely polluted) roads</li>
<li>Measures of pedestrian safety, e.g. pedestrian fatalities per billion km (bkm) walked (where available)</li>
<li>Connectivity, which can be measured in terms of average circuity for walking trips</li>
</ul>
</div>
<div id="get-cycling" class="section level3">
<h3 class="hasAnchor">
<a href="#get-cycling" class="anchor"></a>Get cycling</h3>
<p>This scenario refers to a global scenario of cycling, as a result of citywide policies to provide safe cycleways.</p>
<ul>
<li>The the provision of cycling infrastructure, which could be measured as km/person or as a percentage of the length of the total transport network</li>
<li>Number of cycle parking spaces per person</li>
<li>Number of cyclist fatalities per bkm cycled (where available)</li>
<li>The provision of free cycle training facilities</li>
<li>The provision of a cycle hire scheme</li>
</ul>
<p>Other important variables include average gradient, type of cycle network, level or car ownership and directness of cycle routes compared with driving routes <span class="citation">(Parkin, Wardman, and Page 2008)</span>.</p>
</div>
<div id="car-diet" class="section level3">
<h3 class="hasAnchor">
<a href="#car-diet" class="anchor"></a>Car diet</h3>
<p>This scenario refers a global, citywide scenario of multi-modal transport change, showing reduced levels of driving following disincentives to own and use cars. Variables that could be modified in support of this scenario include:</p>
<ul>
<li>The average number of lanes of traffic on roads in a city could be reduced, representing reduction of space on the roads for cars.</li>
<li>The distribution of speed limits in a city, for example represented by the proportion of roads on which the speed limit is above 30, 50 and 100 KM/hr. Real world data from crowd-sourced driving data, e.g. as provided by Uber, could enable the quality of these variables to grow over time</li>
<li>Speed limit enforcement, e.g. measured as number of prosecutions per bkm driven</li>
<li>Fuel tax</li>
</ul>
</div>
<div id="go-public-transport" class="section level3">
<h3 class="hasAnchor">
<a href="#go-public-transport" class="anchor"></a>Go public transport</h3>
<p>This scenario is a global scenario of public transport uptake, linked to <a href="https://sustainabledevelopment.un.org/sdg11">SDG 11</a>. It would involve modifying explanatory variables that represent public public transport provision. Variables we could change in this scenario could include:</p>
<ul>
<li>Increase in the number of bus stops per person in the city, a crude measure which has already been demonstrated to be a powerful predictor of multi-mode shift away from cars. A specific scenario could increase the provision of bus stops by the median value in the data as outlined above.</li>
<li>Change in the percentage of the city’s area within walking distance (e.g. 300m) of public transport nodes such as bus stops and rail stations</li>
</ul>
</div>
<div id="go-car-free" class="section level3">
<h3 class="hasAnchor">
<a href="#go-car-free" class="anchor"></a>Go car free</h3>
<p>This scenario refers to investment in car free city centers and other spaces, other locally specific scenarios, such as reductions in car parking spaces.</p>
<ul>
<li>The proportion of the transport network on which cars can travel</li>
<li>The provision of car parking spaces per person</li>
<li>Localized changes, for example making city centers car free, which could feed into the proportion of the network which is car free, weighted by travel levels into the zones which go car free</li>
</ul>
</div>
<div id="other-modifiable-transport-system-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#other-modifiable-transport-system-variables" class="anchor"></a>Other modifiable transport system variables</h3>
<p>In addition to the specific scenarios outlined above, there are other important variables that could be modified in model experiments, either as stand-alone interventions, or to supplement specific scenarios. These include:</p>
<ul>
<li>Percentage of the transport network that is dedicated to motor traffic (an alternative or supplementary measure could be the percentage of the city’s surface area dedicated to motor traffic)</li>
<li>Laws and other policies influencing new modes of transport such as electric bicycles and electric scooters.</li>
</ul>
</div>
<div id="fixed-effects" class="section level3">
<h3 class="hasAnchor">
<a href="#fixed-effects" class="anchor"></a>Fixed effects</h3>
<p>Many variables are outside the scope of policy intervention but are important to consider in models nonetheless. An example of a fixed effect in the example above was population density. However, the predictions of current mode split in Accra were unrealistic because other fixed effects were omitted. There was no variable accounting for the fact that in Accra most people cannot afford a car, for example. Also, differences in culture influence transport systems. Variables to account for these fixed effects could include:</p>
<ul>
<li>Transport variables from the country that the city is in, e.g. % who drive overall</li>
<li>A measure of economic development, inequality-adjusted human development index (<a href="https://en.wikipedia.org/wiki/Human_Development_Index">HDI</a>) bands</li>
<li>Topographic and climate variables</li>
</ul>
</div>
</div>
<div id="data-limitations-and-discussion" class="section level2">
<h2 class="hasAnchor">
<a href="#data-limitations-and-discussion" class="anchor"></a>Data limitations and discussion</h2>
<p>The data requirements of a robust model to estimate mode shift in the Bayesian, multi-model framework outlined above are substantial. The preliminary results are inherently limited by the small size and skewed nature of the input city dataset, shown in the map.</p>
<p><img src="https://pbs.twimg.com/media/EJf-Vo5WoAIfXQ2?format=png&amp;name=900x900"><!-- --></p>
<p>The map shows that there are only 2 cities with a high (40% +) level of walking, and these were cities that we added to the cities dataset. <strong>A priority for future is to expand this cities dataset to make it larger and more representative of cities where the Upthat tool is most likely to be used.</strong></p>
<p>Scenario development accounting for the transport systems in Accra and Kathmandu, as part of UHI project activities, must be based on current transport data. An overview for Ghana (a proxy for the travel pattern in Accra) is shown below.</p>
<p>A more subtle data limitation surrounds modal categories. This is highlighted in the figure below which shows the full diversity of modes used in Accra from survey data on the left, and the effect of simplifying these categories into the modes which are most commonly reported. <strong>Future research should explore ways to gain data on and incorporate a richer diversity of transport modes.</strong></p>
<p>A more conceptual question is how to account for the ordered nature of transport systems, e.g.:</p>
<p>Walking &gt; Cycling &gt; Public Transport &gt; Cars</p>
<p>In terms of typical costs per km (assuming you have access to a bicycle) and the reverse order in terms of maximum speeds and energy costs per km. The framework outlined above could accept an arbitrary number of modes and mode size, speed and energy requirements could be accounted for by adding hybrid variables such as ‘maximum potential mode share by mode walking/cycling’ based on data on average trip distances per city (which may not be available for most cities) and distance decay parameters published in the literature.</p>
<p><img src="https://github.com/ATFutures/who3/raw/master/figures/modes-ghana-work.png" width="50%"><img src="https://github.com/ATFutures/who3/raw/master/figures/modes-ghana-work-simple.png" width="50%"></p>
</div>
</div>
<div id="adapting-the-scenarios-of-change" class="section level1">
<h1 class="hasAnchor">
<a href="#adapting-the-scenarios-of-change" class="anchor"></a>Adapting the scenarios of change</h1>
<p>The previous section outlines how additional of change can be added within the Bayesian framework using Dirichlet regression. The largest barrier to accurate predictions of mode shift following certain interventions, such as those described in the 5 scenarios above, was identified as being lack of data on mode split across cities, let alone with multiple time series enabling models to predict not only mode shift levels but change. This barrier is not insurmountable. If larger datasets on the dependent variable become available, the scenarios can be adapted to new city datasets as follows:</p>
<ul>
<li>Acquisition of explanatory variables on transport systems. This can be done using bulk download and processing of OSM data, as has been demonstrated with the example of bus stops and tram systems above. Getting more explanatory variables for a larger sample size will take considerable time, perhaps 1 data scientist day per new variable added and 1 day per 200 cities.</li>
<li>Model training, assessment and prediction. This stage takes considerable time due to the computationally intensive nature of Markov chain Monte Carlo (MCMC) sampling used in Bayesian data analysis <span class="citation">(McElreath 2016)</span>.</li>
<li>Estimates of uncertainty not only in the point estimates of mode split, but in the level of change that can be expected following specific interventions. For the confidence intervals displayed in the previous section to apply to the uptake of walking and cycling an extra stage is needed. This should not be difficult for a skilled Bayesian statistician but could take days for a data analyst new to the field of Bayesian statistics.</li>
<li>Refining the methods by which the top-down estimates of mode split feed into the flow generation model outlined in the calibration paper. In theory, the relationship between the top-down and bottom-up approaches should be two-way, because important information on a city’s transport system is ascertained in the process of routing across its transport network.</li>
</ul>
<p>The bullet points above show that all of the technology and most of the data (although this is continuously evolving and depends on better mode split data across cities internationally) already exists for this approach to be deployed internationally and provides an indication of the amount of work required to do so.</p>
</div>
<div id="adapting-the-web-app" class="section level1">
<h1 class="hasAnchor">
<a href="#adapting-the-web-app" class="anchor"></a>Adapting the web app</h1>
<p>The Upthat web app itself is fully reproducible. An up-to-date R installation on a modern computer should reproduce a fully working version of the app with the following commands:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">remotes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/remotes/man/install_github.html">install_github</a></span>(<span class="st">"atfutures/upthat"</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">upthat<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/upthat/man/runUpthat.html">runUpthat</a></span>()</a></code></pre></div>
<p>To modify the Upthat source code, download the repo and open it in an editor such as RStudio, e.g. with the following commands on a Linux terminal:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="fu">git</span> clone git@github.com:atfutures/upthat</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="ex">rstudio</span> upthat/upthat.Rproj</a></code></pre></div>
<p>To view the updated version of the app after making changes rebuild it, e.g. with <code>Ctl+Shift+B</code> in RStudio and then re-run the app with the command <code><a href="../reference/runUpthat.html">runUpthat()</a></code>. For more on modifying <code>shiny</code> apps see the documentation associated with the package <span class="citation">(Chang et al. 2015)</span>or the in progress open source book <a href="https://mastering-shiny.org/"><em>Mastering Shiny</em></a> <span class="citation">(Wickham 2020)</span>.</p>
</div>
<div id="deploying-upthat" class="section level1">
<h1 class="hasAnchor">
<a href="#deploying-upthat" class="anchor"></a>Deploying upthat</h1>
<p>To deploy a tool like Upthat so that it is publicly available as an interactive web app, the following resources are required:</p>
<ul>
<li>A physical server with a reliable and fast internet connection or access to cloud compute resources</li>
<li>System administrator with web server experience to set-up Upthat on <code>shiny-server</code>
</li>
<li>A skilled R developer to maintain packages and update Upthat with new data</li>
<li>A domain such as youcity.gov to provide a stable url to the app, e.g. www.yourcity.gov/upthat</li>
</ul>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-aguilera_passenger_2014">
<p>Aguil’era, Anne, and Jean Gr’ebert. 2014. “Passenger Transport Mode Share in Cities: Exploration of Actual and Future Trends with a Worldwide Survey.” <em>International Journal of Automotive Technology and Management</em> 14 (3-4): 203–16. <a href="https://doi.org/10.1504/IJATM.2014.065290" class="uri">https://doi.org/10.1504/IJATM.2014.065290</a>.</p>
</div>
<div id="ref-burkner_brms_2017">
<p>Bürkner, Paul-Christian. 2017. “Brms: An R Package for Bayesian Multilevel Models Using Stan.” <em>Journal of Statistical Software</em> 80 (1): 1–28. <a href="https://doi.org/10.18637/jss.v080.i01" class="uri">https://doi.org/10.18637/jss.v080.i01</a>.</p>
</div>
<div id="ref-chang_shiny_2015">
<p>Chang, Winston, Joe Cheng, J J Allaire, Yihui Xie, and Jonathan McPherson. 2015. <em>Shiny: Web Application Framework for R</em>.</p>
</div>
<div id="ref-douma_analysing_2019">
<p>Douma, Jacob C., and James T. Weedon. 2019. “Analysing Continuous Proportions in Ecology and Evolution: A Practical Introduction to Beta and Dirichlet Regression.” <em>Methods in Ecology and Evolution</em> 10 (9): 1412–30. <a href="https://doi.org/10.1111/2041-210X.13234" class="uri">https://doi.org/10.1111/2041-210X.13234</a>.</p>
</div>
<div id="ref-kerr_jacqueline_perceived_2016">
<p>Kerr Jacqueline, Emond Jennifer A., Badland Hannah, Reis Rodrigo, Sarmiento Olga, Carlson Jordan, Sallis James F., et al. 2016. “Perceived Neighborhood Environmental Attributes Associated with Walking and Cycling for Transport Among Adult Residents of 17 Cities in 12 Countries: The IPEN Study.” <em>Environmental Health Perspectives</em> 124 (3): 290–98. <a href="https://doi.org/10.1289/ehp.1409466" class="uri">https://doi.org/10.1289/ehp.1409466</a>.</p>
</div>
<div id="ref-lovelace_propensity_2017">
<p>Lovelace, Robin, Anna Goodman, Rachel Aldred, Nikolai Berkoff, Ali Abbas, and James Woodcock. 2017. “The Propensity to Cycle Tool: An Open Source Online System for Sustainable Transport Planning.” <em>Journal of Transport and Land Use</em> 10 (1). <a href="https://doi.org/10.5198/jtlu.2016.862" class="uri">https://doi.org/10.5198/jtlu.2016.862</a>.</p>
</div>
<div id="ref-maier_dirichletreg_2014">
<p>Maier, Marco J. 2014. “DirichletReg: Dirichlet Regression for Compositional Data in R.” 125. Department of Statistics and Mathematics, WU Vienna.</p>
</div>
<div id="ref-mcelreath_statistical_2016">
<p>McElreath, Richard. 2016. <em>Statistical Rethinking: A Bayesian Course with Examples in R and Stan</em>. 1 edition. Boca Raton: Chapman and Hall/CRC.</p>
</div>
<div id="ref-parkin_estimation_2008">
<p>Parkin, John, Mark Wardman, and Matthew Page. 2008. “Estimation of the Determinants of Bicycle Mode Share for the Journey to Work Using Census Data.” <em>Transportation</em> 35 (1): 93–109. <a href="https://doi.org/10.1007/s11116-007-9137-5" class="uri">https://doi.org/10.1007/s11116-007-9137-5</a>.</p>
</div>
<div id="ref-tight_visions_2011">
<p>Tight, Miles, Paul Timms, David Banister, Jemma Bowmaker, Jonathan Copas, Andy Day, David Drinkwater, et al. 2011. “Visions for a Walking and Cycling Focussed Urban Transport System.” <em>Journal of Transport Geography</em> 19 (6): 1580–9. <a href="https://doi.org/10.1016/j.jtrangeo.2011.03.011" class="uri">https://doi.org/10.1016/j.jtrangeo.2011.03.011</a>.</p>
</div>
<div id="ref-wickham_mastering_2020">
<p>Wickham, Hadley. 2020. <em>Mastering Shiny</em>.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p> See the <a href="https://github.com/ATFutures/who3/tree/master/calibration">calibration report</a> for details on the methods used to distribute trips across transport networks and estimating exposure to air pollution and physical activity.<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li>
<a href="#scenarios">Scenarios</a><ul class="nav nav-pills nav-stacked">
<li><a href="#citywide-scenarios-of-change">Citywide scenarios of change</a></li>
      <li><a href="#transport-system-data">Transport system data</a></li>
      <li><a href="#modelling-mode-shift">Modelling mode shift</a></li>
      <li><a href="#estimates-of-rates-of-shift-towards-walking-and-cycling-down-to-route-network-levels">Estimates of rates of shift towards walking and cycling down to route network levels</a></li>
      <li><a href="#data-limitations-and-discussion">Data limitations and discussion</a></li>
      </ul>
</li>
      <li><a href="#adapting-the-scenarios-of-change">Adapting the scenarios of change</a></li>
      <li><a href="#adapting-the-web-app">Adapting the web app</a></li>
      <li><a href="#deploying-upthat">Deploying upthat</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
